<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>EC2利用tasksel架wordpress經驗分享</title>
  <meta name="description" content="記錄開發過程大小事" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <meta property="og:title" content="kpman | code"/>
  <meta property="og:type" content="blog"/>
  <meta property="og:url" content="http://code.kpman.cc"/>
  <meta property="og:image" content="https://dl.dropboxusercontent.com/u/24235947/kpman.png"/>
  <meta property="og:site_name" content="kpman | code"/>
  <meta property="fb:admins" content="100001196448561"/>
  <meta property="og:description"
        content="A man, A powerful man, kpman."/>

  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />

  <meta name="generator" content="kpman | code">

  
  
  

  
</head>


<body class="post-template">

  

<main class="content" role="main">
  <article class="post">
    <header class="post-header">
      <a class="blog-logo" href="/">
        
        <img src="//dl.dropboxusercontent.com/u/24235947/kpman.png" alt="Blog Logo"/></a>
        
      </a>
    </header>
    <span class="post-meta">
      <time datetime="2013-08-20T18:17:04.000Z" itemprop="datePublished">Aug 21 2013</time>
       on <a href='/tags/wordpress/' style='margin:0 5px;'>wordpress</a><a href='/tags/Amazon/' style='margin:0 5px;'>Amazon</a><a href='/tags/EC2/' style='margin:0 5px;'>EC2</a><a href='/tags/tasksel/' style='margin:0 5px;'>tasksel</a><a href='/tags/ubuntu/' style='margin:0 5px;'>ubuntu</a><a href='/tags/AWS/' style='margin:0 5px;'>AWS</a>
    </span>
    <h1 class="post-title">EC2利用tasksel架wordpress經驗分享</h1>
    <section class="post-content">
      <p>看了這麼久的雲端資源，總算開了算是自己真正學到東西的第一台Amazon EC2 server，目的是想要練習把wordpress架到EC2上，在此分享我的架設經驗。</p>
<p><img src="http://blog.programmableweb.com/wp-content/amazon-web-services1.png" alt="Amazon web service"></p>
<a id="more"></a>

<h2 id="一、擁有AWS帳號">一、擁有AWS帳號</h2>
<p>關於開啟AWS的過程，實際走過一遍之後，阿正老師的<a href="http://blog.soft.idv.tw/?p=823&amp;page=2" target="_blank">這篇</a>，其內寫的不錯，推薦跟著走一遍，就會了解很多。</p>
<h2 id="二、開啟自己的instance">二、開啟自己的instance</h2>
<p>在實際走過後，會發現阿正老師<a href="http://blog.soft.idv.tw/?p=824" target="_blank">這篇</a>真的超用心，因此接下來主要會利用這篇，再加上些我的補充。</p>
<ul>
<li>instance地理位置</li>
</ul>
<p>提到將主機開的位置，現在已經有tokyo的據點，離台灣更近，所以建議將instance位置設在tokyo</p>
<blockquote>
<p>建議將instance位置設在tokyo</p>
</blockquote>
<ul>
<li>instance選擇方案</li>
</ul>
<p><img src="http://i.imgur.com/U4rs7wk.png" alt="EC2 ubuntu server for free"></p>
<p>利用VISA卡，選擇免費方案（圖中有星星的都是免費方案），在這邊我選擇ubuntu來做為我的系統。</p>
<ul>
<li>key pair創建＆下載</li>
</ul>
<p>在阿正老師的文章內看到關於key pair介紹，很重要，一定要記住要把下載下來的pem給管理好，未來是需要利用它來做ssh登入主機。</p>
<blockquote>
<p>.pem檔需要存好，一台主機配對一個key pair，且不能做更改，</p>
</blockquote>
<h2 id="三、設定Security_Group">三、設定Security Group</h2>
<p>在沒有設定security group的時候，新開的instance可能是鎖起來的，會有SSH連線上的問題。</p>
<ol>
<li>進入console.aws.amazon.com</li>
<li>左方導覽列選擇security group</li>
<li>選擇instance後，下方的tab選取<code>Inbound</code></li>
<li>分別加入<code>SSH</code>&amp;<code>HTTP</code>，Source部分都維持0.0.0.0/0即可，加入後記得要按<code>Apply Rule Change</code>才生效</li>
</ol>
<blockquote>
<p>記得開啟SSH(20)、HTTP(80)</p>
</blockquote>
<h2 id="四、申請Elastic_IP">四、申請Elastic IP</h2>
<p>每一個instance都應該要綁定一個elastice ip，未來可以作為連線使用。</p>
<ol>
<li>同上，進入console.aws.amazon.com</li>
<li>選擇Elastic IPs</li>
<li>選擇Allocate New Address</li>
<li>申請完之後記得要associate到你的instance </li>
</ol>
<blockquote>
<p>申請完elastic ip後，原本的Public domain前半部分會改變為新的ip</p>
</blockquote>
<p><strong><em>* 其實我在實作時，是先做了SSH連線，後來在去申請elastic ip，結果associate完後，我又要ssh連線，發現沒有辦法登入，之後才瞭解是做了elastic ip後，連線的ip也需要一並跟著改變。</em></strong></p>
<h2 id="五、SSH連線進入自己的instance">五、SSH連線進入自己的instance</h2>
<ol>
<li>打開終端機（推薦iterm）</li>
<li><code>chmod 600 ~/.pem</code><br>要記得把.pem檔改權限，不然會登不進去</li>
<li>ssh連線使用以下command line<br><code>ssh -i ~/.pem ubuntu@ip</code><ul>
<li><code>~/.pem</code>是此instance的key pair .pem檔的路徑</li>
<li><code>ubuntu</code>是因為我用ubuntu當做OS，如果當初選擇Amazon linux的話，則需要輸入<code>ec2-user</code>取代ubuntu</li>
<li><code>ip</code>則為instance的ip，進到console，左側選instance，拉到底下看見<br><code>Public DNS: ec2-xx-xxx-xxx-xx.ap-northeast-1.compute.amazonaws.com</code><br>則xx-xxx-xxx-xx改成<code>xx.xxx.xxx.xx</code>即為你的連線ip</li>
</ul>
</li>
<li>連線成功會看到<code>ubuntu@ip-xxx-xxx-xxx-xxx:~$</code>字眼！那就恭喜了！</li>
</ol>
<blockquote>
<p>pem檔的權限要更改為600</p>
</blockquote>
<h2 id="六、環境設定">六、環境設定</h2>
<p>剛進到instance，記得將環境設定一下</p>
<ol>
<li><code>sudo apt-get update</code> + <code>sudo apt-get upgrade</code></li>
<li>如果覺得一直sudo很麻煩，可以利用<code>sudo su</code>取得root權限</li>
</ol>
<hr>
<h3 id="#_安裝tasksel"># 安裝tasksel</h3>
<ol>
<li>是ubuntu底下的lamp懶人包</li>
<li>推薦<a href="http://howtounix.info/howto/LAMP-on-Ubuntu-with-tasksel-tool" target="_blank">教學文</a></li>
<li>開始安裝taskel   <code>sudo apt-get install tasksel</code></li>
<li>安裝lamp-server   <code>sudo tasksel install lamp-server</code></li>
</ol>
<h3 id="#_安裝phpmyadmin"># 安裝phpmyadmin</h3>
<ol>
<li><code>sudo apt-get install phpmyadmin</code></li>
<li><a href="http://linadonis.pixnet.net/blog/post/27585552-ubuntu-server-%E5%AE%89%E8%A3%9D-phpmyadmin" target="_blank">reference</a></li>
</ol>
<h3 id="#_安裝wordpress"># 安裝wordpress</h3>
<p><img src="http://wow-wp.org/wp-content/uploads/2011/10/wordpress.png" alt="wordpress"></p>
<ol>
<li><a href="https://www.digitalocean.com/community/articles/how-to-install-wordpress-on-ubuntu-12-04" target="_blank">超棒教學文</a> 我是跟著文章走，裡面紅色的字記得改成自己的</li>
</ol>
<ul>
<li>cd /var/www</li>
<li>下載wordpress包<br><code>wget http://wordpress.org/latest.tar.gz</code>   </li>
<li>解壓縮<br><code>tar -xzvf latest.tar.gz</code></li>
<li>進到mysql mode<br><code>mysql -u root -p</code></li>
<li>剩下有紅字，推薦看連結XD</li>
</ul>
<h2 id="七、測試連線">七、測試連線</h2>
<p>當你安裝完後，事實上可以利用public domain來連線看看<br>直接在console裡面找到instance的public domian，連線看看是否成功</p>
<ol>
<li><code>cd /var/www</code> </li>
<li><code>sudo vi test.php</code> 創新php檔案，並進到vim模式</li>
<li>按<code>i</code> 進入編輯模式，記得看下面是否出現<code>-- INSERT --</code></li>
<li>打上這一行<code>&lt;?php phpinfo(); ?&gt;</code></li>
<li>按下esc -&gt; 打入<code>:wq</code> -&gt; enter存檔(記得是看iterm下面)</li>
<li>利用public domain/test.php連線測試，看到php的資訊就成功了！</li>
<li>public domain/wordpress 也可以看見你的wordpress有沒有架成功！</li>
</ol>
<h2 id="IP連接instance">IP連接instance</h2>
<p>如果你有自己的ip，想要指到EC2的話，按照下面作法。</p>
<ol>
<li>到godday的DNS manager</li>
</ol>
<ul>
<li>設定你的IP的<code>A record</code></li>
<li>指向instance的<code>Elastic IP</code>即可</li>
</ul>
<p><strong><em>reference</em></strong></p>
<ul>
<li><a href="http://blog.soft.idv.tw/?p=823&amp;page=2" target="_blank">阿正老師上篇</a> 阿正老師這兩篇必讀</li>
<li><a href="http://blog.soft.idv.tw/?p=824" target="_blank">阿正老師下篇</a> 主機實戰篇</li>
<li><a href="http://blog.rx836.tw/blog/first-amazon-web-services/" target="_blank">免費玩Amazon Web Service(AWS) EC2</a> 開機器寫的很詳細，圖文並茂</li>
<li><a href="http://coenraets.org/blog/2012/01/setting-up-wordpress-on-amazon-ec2-in-5-minutes/" target="_blank">Setting Up WordPress on Amazon EC2 in 5 minutes</a> 根本神教學，我是受這篇感動才想要把自己的過程給記錄下來。</li>
<li><a href="http://linadonis.pixnet.net/blog/post/27585552-ubuntu-server-%E5%AE%89%E8%A3%9D-phpmyadmin" target="_blank">Ubuntu Server 安裝 Phpmyadmin</a> phpmyadmin圖文教學</li>
<li><a href="http://codex.wordpress.org/Giving_WordPress_Its_Own_Directory" target="_blank">Giving WordPress Its Own Directory</a> 更換wordpress的路徑位置指向</li>
</ul>
<blockquote>
<p>如果有問題，或者我有寫錯的地方，歡迎留言讓我知道！</p>
</blockquote>

    </section>
      <section id="comment">
          <h1 class="title">Comments</h1>

          
          <div id="disqus_thread">
              <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
          
      </section>
    <footer class="post-footer">
      <section class="author">
        <h4>kpman | code</h4>
        <p>A man, A powerful man, kpman.</p>
      </section>

      <section class="share">
        <h4>Share this post</h4>
        <a class="icon-twitter" href="http://twitter.com/share?url=http://code.kpman.cc/2013/08/21/ec2利用tasksel架wordpress經驗分享/"
          onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <span class="hidden">Twitter</span>
        </a>
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://code.kpman.cc/2013/08/21/ec2利用tasksel架wordpress經驗分享/"
          onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <span class="hidden">Facebook</span>
        </a>
        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://code.kpman.cc/2013/08/21/ec2利用tasksel架wordpress經驗分享/"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
          <span class="hidden">Google+</span>
        </a>
      </section>
    </footer>
  </article>
</main>


  
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">kpman | code</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>



<script type="text/javascript">
    var disqus_shortname = 'kpmancode';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




</body>
</html>
